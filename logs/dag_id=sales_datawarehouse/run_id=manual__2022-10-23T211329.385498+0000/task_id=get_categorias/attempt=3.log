[2022-10-23T21:20:44.832+0000] {taskinstance.py:1165} INFO - Dependencies all met for <TaskInstance: sales_datawarehouse.get_categorias manual__2022-10-23T21:13:29.385498+00:00 [queued]>
[2022-10-23T21:20:44.884+0000] {taskinstance.py:1165} INFO - Dependencies all met for <TaskInstance: sales_datawarehouse.get_categorias manual__2022-10-23T21:13:29.385498+00:00 [queued]>
[2022-10-23T21:20:44.888+0000] {taskinstance.py:1362} INFO - 
--------------------------------------------------------------------------------
[2022-10-23T21:20:44.890+0000] {taskinstance.py:1363} INFO - Starting attempt 3 of 4
[2022-10-23T21:20:44.892+0000] {taskinstance.py:1364} INFO - 
--------------------------------------------------------------------------------
[2022-10-23T21:20:44.942+0000] {taskinstance.py:1383} INFO - Executing <Task(PythonOperator): get_categorias> on 2022-10-23 21:13:29.385498+00:00
[2022-10-23T21:20:44.960+0000] {standard_task_runner.py:54} INFO - Started process 1074 to run task
[2022-10-23T21:20:44.979+0000] {standard_task_runner.py:82} INFO - Running: ['***', 'tasks', 'run', 'sales_datawarehouse', 'get_categorias', 'manual__2022-10-23T21:13:29.385498+00:00', '--job-id', '159', '--raw', '--subdir', 'DAGS_FOLDER/sales_dw.py', '--cfg-path', '/tmp/tmpzkk83e3h']
[2022-10-23T21:20:44.983+0000] {standard_task_runner.py:83} INFO - Job 159: Subtask get_categorias
[2022-10-23T21:20:44.990+0000] {dagbag.py:525} INFO - Filling up the DagBag from /opt/***/dags/sales_dw.py
[2022-10-23T21:20:46.979+0000] {task_command.py:384} INFO - Running <TaskInstance: sales_datawarehouse.get_categorias manual__2022-10-23T21:13:29.385498+00:00 [running]> on host 83cd0ab98720
[2022-10-23T21:20:47.327+0000] {taskinstance.py:1592} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=pedromenegat
AIRFLOW_CTX_DAG_ID=sales_datawarehouse
AIRFLOW_CTX_TASK_ID=get_categorias
AIRFLOW_CTX_EXECUTION_DATE=2022-10-23T21:13:29.385498+00:00
AIRFLOW_CTX_TRY_NUMBER=3
AIRFLOW_CTX_DAG_RUN_ID=manual__2022-10-23T21:13:29.385498+00:00
[2022-10-23T21:20:47.858+0000] {taskinstance.py:1851} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 175, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 193, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/sales_dw.py", line 42, in get_categorias
    categorias = pd.read_parquet(url, engine='auto')#requests.get(url).content
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/parquet.py", line 500, in read_parquet
    **kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/parquet.py", line 236, in read
    mode="rb",
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/parquet.py", line 102, in _get_path_or_handle
    path_or_handle, mode, is_text=False, storage_options=storage_options
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/common.py", line 614, in get_handle
    storage_options=storage_options,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/common.py", line 312, in _get_filepath_or_buffer
    with urlopen(req_info) as req:
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/common.py", line 212, in urlopen
    return urllib.request.urlopen(*args, **kwargs)
  File "/usr/local/lib/python3.7/urllib/request.py", line 222, in urlopen
    return opener.open(url, data, timeout)
  File "/usr/local/lib/python3.7/urllib/request.py", line 531, in open
    response = meth(req, response)
  File "/usr/local/lib/python3.7/urllib/request.py", line 641, in http_response
    'http', request, response, code, msg, hdrs)
  File "/usr/local/lib/python3.7/urllib/request.py", line 569, in error
    return self._call_chain(*args)
  File "/usr/local/lib/python3.7/urllib/request.py", line 503, in _call_chain
    result = func(*args)
  File "/usr/local/lib/python3.7/urllib/request.py", line 649, in http_error_default
    raise HTTPError(req.full_url, code, msg, hdrs, fp)
urllib.error.HTTPError: HTTP Error 404: Not Found
[2022-10-23T21:20:47.893+0000] {taskinstance.py:1406} INFO - Marking task as UP_FOR_RETRY. dag_id=sales_datawarehouse, task_id=get_categorias, execution_date=20221023T211329, start_date=20221023T212044, end_date=20221023T212047
[2022-10-23T21:20:47.927+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 159 for task get_categorias (HTTP Error 404: Not Found; 1074)
[2022-10-23T21:20:47.970+0000] {local_task_job.py:164} INFO - Task exited with return code 1
[2022-10-23T21:20:48.030+0000] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
